## 第七章 创建高性能的索引
#### 索引类型
索引是在存储引擎层实现的，因此讨论索引时，都是讨论某个存储引擎的索引实现。下面讨论的都是InnoDB引擎的索引实现。
会走索引的场景（字符串类型为例)：
- 全值匹配、匹配最左前缀、匹配列前缀。这三种方式都是按照最左匹配原则进行匹配，而这里的匹配可以精确到字母，即某一个列中的字母也符合最左匹配原则。
- 匹配范围值、精确匹配某一列而范围匹配另一列。范围匹配和精确匹配某一部分后的范围匹配都会使用索引。
#### 使用索引的优点
- 索引大大减少了服务器需要扫描的数据量
- 索引可以帮助服务器避免排序和临时表
- 索引可以将随机I/O变为顺序I/O
评价一个索引是否适合某个语句：
1. 索引将相关数据放在一起
2. 索引中的数据顺序和查询语句中的顺序一致
3. 索引中包含了查询语句中所需要的全部列
#### 选择合适的索引列顺序
> 当使用前缀索引的时候，在某些条件值的基数比正常值高的时候，问题就来了。例如，在某些应用程序中，对于没有登录的用户，都将其用户名记录为“guset”，在记录用户行为的会话（session）表和其他记录用户活动的表中，“guest”就成为一个特殊用户ID，一旦查询涉及这个用户，那么和对于正常用户的查询就大不相同了，因为通常有很多会话都是没有登录的。有些系统账号也会导致类似的问题。一个应用通常都有一个特殊的管理员账号，和普通账号不同，它并不是一个具体的用户，系统中所有的其他用户都是这个用户的好友，所以系统往往通过它向网站的所有用户发送状态通知和其他消息。这个账号的巨大的好友列表很容易导致网站出现服务器性能问题。
###### GPT4:
这段话主要在讨论前缀索引在处理一些特殊情况时可能出现的性能问题。
前缀索引通常用于数据库中对字符类型的字段进行索引，以加快查询速度。但是，当某些条件值的基数（唯一值的数量）较高时，可能会产生问题。比如，如果一个应用程序把所有未登录用户的用户名都记为“guest”，那么在记录用户行为的session表和其他活动记录表中，“guest”就成了一个特殊的用户ID。如果有大量的会话关联到这个用户，那么查询涉及这个用户的数据就会非常耗时。
同样的问题也可能发生在系统账号上。例如，一个应用可能会有一个特别的管理员账号，它并不代表一个真实的用户，而是被用来管理系统，向所有用户发送通知等操作。这个账号可能拥有海量的好友，因此当我们查询与它相关的信息时，可能导致服务器性能下降。
简单来说，这段话讲述的是在设计数据库和应用系统时，需要考虑到一些特别的使用场景（如特殊账号或者具有大量数据的账号等），否则可能导致数据库查询效率低下，甚至影响整个系统的性能。